---
title: "Analysis of Loan Grades"
output: html_document
bibliography: bibliographies.bib
vignette: >
    %\VignetteIndexEntry{Exploratory Analysis- Loan Amount} 
    %\VignetteEngine{knitr::rmarkdown}\usepackage[utf8]{inputenc} 
---

```{r, echo=F}
options(scipen = 6)
knitr::opts_chunk$set(cache=FALSE, fig.height=3, fig.width = 7, comment=NULL, eval=T, tidy=F, width=80, message= FALSE, echo= FALSE, warning = FALSE)
```

```{r, child="snippet/_preamble.Rmd"}
```


```{r, child="snippet/_nofilter.Rmd"}
```

## Loan Distribution by Grade

```{r}
LoanData %>%
    group_by(grade) %>%
    summarize(Total= n()) %>%
    mutate(Proportion= Total/sum(Total)) %>%
    knitr::kable(align=c('l','r','r'),
                 digits=c(0,0,2),
                 caption= "Distribution by Loan Grade",
                 format.args = list(big.mark=','),
                 col.names = c("Grade","Total","Proportion"))
```

There are `r format(nrow(LoanData),big.mark=",")` loans in the dataset. The median loan grade level is `r LETTERS[median(as.numeric(factor(LoanData$grade)))]` with the distribution skewed towards the lower loan grades. 

```{r}
LoanData %>%
    mutate(Year= format(issue_d,"%Y")) %>%
    group_by(Year) %>%
    summarise(N=n()) %>%
    knitr::kable(format.args = list(big.mark=","),
                 align=c("l","r"),
                 col.names=c("Year","Count"))
```

The number of loans per year has grown significantly since 2011 but has leveled off since 2015.  The CAGR from 2011 to 2016 is `r round((434401/42535)^(1/5)-1,2)`. 

```{r}
LoanData %>%
    mutate(Year= format(issue_d,"%Y")) %>%
    group_by(Year, grade) %>%
    summarize(N=n()) %>%
    mutate(share= round(N/sum(N),2)) %>%
    select(-N) %>%
    spread(key=Year, value=share)
```
### Package Version
The analysis was based on LendingClubData version `r packageVersion("LendingClubData")`.

### References